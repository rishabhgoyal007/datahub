"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[897],{15680:(e,n,t)=>{t.d(n,{xA:()=>s,yg:()=>c});var a=t(96540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var g=a.createContext({}),d=function(e){var n=a.useContext(g),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},s=function(e){var n=d(e.components);return a.createElement(g.Provider,{value:n},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},p=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,g=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),u=d(t),p=r,c=u["".concat(g,".").concat(p)]||u[p]||m[p]||i;return t?a.createElement(c,l(l({ref:n},s),{},{components:t})):a.createElement(c,l({ref:n},s))}));function c(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,l=new Array(i);l[0]=p;var o={};for(var g in n)hasOwnProperty.call(n,g)&&(o[g]=n[g]);o.originalType=e,o[u]="string"==typeof e?e:r,l[1]=o;for(var d=2;d<i;d++)l[d]=t[d];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},73950:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>g,default:()=>c,frontMatter:()=>o,metadata:()=>d,toc:()=>u});t(96540);var a=t(15680);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}const o={title:"Semantic Search Configuration Guide",slug:"/dev-guides/semantic-search/configuration",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/dev-guides/semantic-search/CONFIGURATION.md"},g="Semantic Search Configuration Guide",d={unversionedId:"docs/dev-guides/semantic-search/CONFIGURATION",id:"docs/dev-guides/semantic-search/CONFIGURATION",title:"Semantic Search Configuration Guide",description:"This guide covers all configuration options for DataHub's semantic search, including embedding models, index settings, and environment variables.",source:"@site/genDocs/docs/dev-guides/semantic-search/CONFIGURATION.md",sourceDirName:"docs/dev-guides/semantic-search",slug:"/dev-guides/semantic-search/configuration",permalink:"/docs/dev-guides/semantic-search/configuration",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/dev-guides/semantic-search/CONFIGURATION.md",tags:[],version:"current",frontMatter:{title:"Semantic Search Configuration Guide",slug:"/dev-guides/semantic-search/configuration",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/dev-guides/semantic-search/CONFIGURATION.md"}},s={},u=[{value:"Enabling Semantic Search",id:"enabling-semantic-search",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Application Configuration",id:"application-configuration",level:3},{value:"Embedding Models",id:"embedding-models",level:2},{value:"Understanding Embedding Providers",id:"understanding-embedding-providers",level:3},{value:"Ingestion via MCP (Metadata Change Proposal)",id:"ingestion-via-mcp-metadata-change-proposal",level:3},{value:"GMS Query Embedding Provider (Java)",id:"gms-query-embedding-provider-java",level:3},{value:"AWS Bedrock (Default)",id:"aws-bedrock-default",level:4},{value:"Other Providers (Cohere Direct, OpenAI, etc.)",id:"other-providers-cohere-direct-openai-etc",level:4},{value:"Custom/Self-Hosted Providers",id:"customself-hosted-providers",level:4},{value:"Index Configuration",id:"index-configuration",level:2},{value:"k-NN Settings",id:"k-nn-settings",level:3},{value:"Parameter Tuning",id:"parameter-tuning",level:3},{value:"Multiple Models",id:"multiple-models",level:3},{value:"Query Configuration",id:"query-configuration",level:2},{value:"GMS Query Settings",id:"gms-query-settings",level:3},{value:"Query Parameters",id:"query-parameters",level:3},{value:"Chunking Configuration",id:"chunking-configuration",level:2},{value:"Monitoring",id:"monitoring",level:2},{value:"Useful Queries",id:"useful-queries",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Debug Logging",id:"debug-logging",level:3}],m={toc:u},p="wrapper";function c(e){var{components:n}=e,t=l(e,["components"]);return(0,a.yg)(p,i(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),a.forEach((function(n){r(e,n,t[n])}))}return e}({},m,t),{components:n,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"semantic-search-configuration-guide"},"Semantic Search Configuration Guide"),(0,a.yg)("p",null,"This guide covers all configuration options for DataHub's semantic search, including embedding models, index settings, and environment variables."),(0,a.yg)("h2",{id:"enabling-semantic-search"},"Enabling Semantic Search"),(0,a.yg)("h3",{id:"environment-variables"},"Environment Variables"),(0,a.yg)("p",null,"Set these in your deployment configuration (e.g., ",(0,a.yg)("inlineCode",{parentName:"p"},"docker/profiles/empty2.env"),"):"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"# Enable semantic search feature\nELASTICSEARCH_SEMANTIC_SEARCH_ENABLED=true\n\n# Entity types to enable (comma-separated)\nELASTICSEARCH_SEMANTIC_SEARCH_ENTITIES=document\n\n# Vector dimensions (must match embedding model)\nELASTICSEARCH_SEMANTIC_VECTOR_DIMENSION=1024\n")),(0,a.yg)("h3",{id:"application-configuration"},"Application Configuration"),(0,a.yg)("p",null,"In ",(0,a.yg)("inlineCode",{parentName:"p"},"metadata-service/configuration/src/main/resources/application.yaml"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"elasticsearch:\n  search:\n    semanticSearch:\n      enabled: ${ELASTICSEARCH_SEMANTIC_SEARCH_ENABLED:false}\n      enabledEntities: ${ELASTICSEARCH_SEMANTIC_SEARCH_ENTITIES:document}\n      models:\n        cohere_embed_v3:\n          vectorDimension: ${ELASTICSEARCH_SEMANTIC_VECTOR_DIMENSION:1024}\n          knnEngine: faiss\n          spaceType: cosinesimil\n          efConstruction: 128\n          m: 16\n")),(0,a.yg)("h2",{id:"embedding-models"},"Embedding Models"),(0,a.yg)("h3",{id:"understanding-embedding-providers"},"Understanding Embedding Providers"),(0,a.yg)("p",null,"There are ",(0,a.yg)("strong",{parentName:"p"},"two separate embedding contexts")," in DataHub's semantic search:"),(0,a.yg)("table",null,(0,a.yg)("thead",{parentName:"table"},(0,a.yg)("tr",{parentName:"thead"},(0,a.yg)("th",{parentName:"tr",align:null},"Context"),(0,a.yg)("th",{parentName:"tr",align:null},"When"),(0,a.yg)("th",{parentName:"tr",align:null},"Who Generates"),(0,a.yg)("th",{parentName:"tr",align:null},"Configuration"))),(0,a.yg)("tbody",{parentName:"table"},(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("strong",{parentName:"td"},"Document Embeddings")),(0,a.yg)("td",{parentName:"tr",align:null},"At ingestion time"),(0,a.yg)("td",{parentName:"tr",align:null},"Ingestion Connector"),(0,a.yg)("td",{parentName:"tr",align:null},"Configured in connector")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("strong",{parentName:"td"},"Query Embeddings")),(0,a.yg)("td",{parentName:"tr",align:null},"At search time"),(0,a.yg)("td",{parentName:"tr",align:null},"GMS"),(0,a.yg)("td",{parentName:"tr",align:null},"Configured in GMS (below)")))),(0,a.yg)("blockquote",null,(0,a.yg)("p",{parentName:"blockquote"},(0,a.yg)("strong",{parentName:"p"},"Important:")," The GMS embedding provider (configured below) is used ",(0,a.yg)("strong",{parentName:"p"},"only for query embedding"),".\nDocument embeddings are generated by the ingestion connector using its own embedding configuration.\nBoth must use the ",(0,a.yg)("strong",{parentName:"p"},"same embedding model")," for semantic search to work correctly.")),(0,a.yg)("h3",{id:"ingestion-via-mcp-metadata-change-proposal"},"Ingestion via MCP (Metadata Change Proposal)"),(0,a.yg)("p",null,"Document embeddings are sent to DataHub via MCP using the ",(0,a.yg)("inlineCode",{parentName:"p"},"SemanticContent")," aspect. This is the standard DataHub pattern for ingesting metadata."),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"MCP Payload Structure:")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "entityType": "document",\n  "entityUrn": "urn:li:document:my-doc-123",\n  "aspectName": "semanticContent",\n  "aspect": {\n    "value": "{...JSON encoded SemanticContent...}",\n    "contentType": "application/json"\n  }\n}\n')),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"SemanticContent Aspect:")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "embeddings": {\n    "cohere_embed_v3": {\n      "modelVersion": "bedrock/cohere.embed-english-v3",\n      "generatedAt": 1702234567890,\n      "chunkingStrategy": "sentence_boundary_400t",\n      "totalChunks": 2,\n      "totalTokens": 450,\n      "chunks": [\n        {\n          "position": 0,\n          "vector": [0.123, -0.456, ...],\n          "characterOffset": 0,\n          "characterLength": 512,\n          "tokenCount": 230,\n          "text": "First chunk of text..."\n        }\n      ]\n    }\n  }\n}\n')),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Privacy Option:")," The ",(0,a.yg)("inlineCode",{parentName:"p"},"text")," field in each chunk is optional. For sensitive data sources, you can omit the source text and send only the embedding vectors."),(0,a.yg)("h3",{id:"gms-query-embedding-provider-java"},"GMS Query Embedding Provider (Java)"),(0,a.yg)("p",null,"GMS uses an ",(0,a.yg)("inlineCode",{parentName:"p"},"EmbeddingProvider")," implementation to generate query embeddings at search time."),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Interface:")," ",(0,a.yg)("inlineCode",{parentName:"p"},"com.linkedin.metadata.search.embedding.EmbeddingProvider")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-java"},"public interface EmbeddingProvider {\n  /**\n   * Returns an embedding vector for the given text.\n   * @param text The text to embed\n   * @param model The model identifier (nullable, uses default if null)\n   * @return The embedding vector\n   */\n  @Nonnull\n  float[] embed(@Nonnull String text, @Nullable String model);\n}\n")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Built-in Implementations:")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"AwsBedrockEmbeddingProvider")," - Uses AWS Bedrock (default)"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"NoOpEmbeddingProvider")," - Throws exception if called (used when semantic search disabled)")),(0,a.yg)("p",null,"The following providers can be configured:"),(0,a.yg)("h4",{id:"aws-bedrock-default"},"AWS Bedrock (Default)"),(0,a.yg)("p",null,"AWS Bedrock provides managed access to embedding models:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"# Environment\nEMBED_PROVIDER=bedrock\nBEDROCK_MODEL=cohere.embed-english-v3\nAWS_REGION=us-west-2\n\n# For local development\nAWS_PROFILE=your-profile\n\n# For production (IAM role or explicit credentials)\nAWS_ACCESS_KEY_ID=...\nAWS_SECRET_ACCESS_KEY=...\n")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Available Bedrock Models:")),(0,a.yg)("table",null,(0,a.yg)("thead",{parentName:"table"},(0,a.yg)("tr",{parentName:"thead"},(0,a.yg)("th",{parentName:"tr",align:null},"Model ID"),(0,a.yg)("th",{parentName:"tr",align:null},"Dimensions"),(0,a.yg)("th",{parentName:"tr",align:null},"Max Tokens"),(0,a.yg)("th",{parentName:"tr",align:null},"Notes"))),(0,a.yg)("tbody",{parentName:"table"},(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"cohere.embed-english-v3")),(0,a.yg)("td",{parentName:"tr",align:null},"1024"),(0,a.yg)("td",{parentName:"tr",align:null},"512"),(0,a.yg)("td",{parentName:"tr",align:null},"Best for English")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"cohere.embed-multilingual-v3")),(0,a.yg)("td",{parentName:"tr",align:null},"1024"),(0,a.yg)("td",{parentName:"tr",align:null},"512"),(0,a.yg)("td",{parentName:"tr",align:null},"Multi-language support")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"amazon.titan-embed-text-v1")),(0,a.yg)("td",{parentName:"tr",align:null},"1536"),(0,a.yg)("td",{parentName:"tr",align:null},"8192"),(0,a.yg)("td",{parentName:"tr",align:null},"Amazon's model")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"amazon.titan-embed-text-v2:0")),(0,a.yg)("td",{parentName:"tr",align:null},"256/512/1024"),(0,a.yg)("td",{parentName:"tr",align:null},"8192"),(0,a.yg)("td",{parentName:"tr",align:null},"Configurable dimensions")))),(0,a.yg)("h4",{id:"other-providers-cohere-direct-openai-etc"},"Other Providers (Cohere Direct, OpenAI, etc.)"),(0,a.yg)("p",null,"Currently, only AWS Bedrock is implemented as a built-in provider. To use other providers (Cohere direct API, OpenAI, etc.), you need to implement a custom ",(0,a.yg)("inlineCode",{parentName:"p"},"EmbeddingProvider"),'. See the "Custom/Self-Hosted Providers" section below.'),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Potential future built-in providers:")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Cohere Direct API"),(0,a.yg)("li",{parentName:"ul"},"OpenAI"),(0,a.yg)("li",{parentName:"ul"},"Azure OpenAI"),(0,a.yg)("li",{parentName:"ul"},"Google Vertex AI")),(0,a.yg)("h4",{id:"customself-hosted-providers"},"Custom/Self-Hosted Providers"),(0,a.yg)("p",null,"To add a custom embedding provider, implement the ",(0,a.yg)("inlineCode",{parentName:"p"},"EmbeddingProvider")," interface and register it in the factory."),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"1. Implement the interface")," (",(0,a.yg)("inlineCode",{parentName:"p"},"metadata-io/src/main/java/com/linkedin/metadata/search/embedding/"),"):"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-java"},"package com.linkedin.metadata.search.embedding;\n\nimport javax.annotation.Nonnull;\nimport javax.annotation.Nullable;\n\npublic class CustomEmbeddingProvider implements EmbeddingProvider {\n\n  private final String endpoint;\n  private final int dimensions;\n\n  public CustomEmbeddingProvider(String endpoint, int dimensions) {\n    this.endpoint = endpoint;\n    this.dimensions = dimensions;\n  }\n\n  @Override\n  @Nonnull\n  public float[] embed(@Nonnull String text, @Nullable String model) {\n    // Call your embedding service\n    // Return float array with `dimensions` elements\n    return callEmbeddingService(endpoint, text, model);\n  }\n}\n")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"2. Register in the factory")," (",(0,a.yg)("inlineCode",{parentName:"p"},"metadata-service/factories/.../EmbeddingProviderFactory.java"),"):"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-java"},'@Bean(name = "embeddingProvider")\n@Nonnull\nprotected EmbeddingProvider getInstance() {\n  // ... existing code ...\n\n  String providerType = config.getType();\n\n  if ("aws-bedrock".equalsIgnoreCase(providerType)) {\n    return new AwsBedrockEmbeddingProvider(...);\n  } else if ("custom".equalsIgnoreCase(providerType)) {\n    return new CustomEmbeddingProvider(\n        config.getCustomEndpoint(),\n        config.getCustomDimensions()\n    );\n  } else {\n    throw new IllegalStateException("Unsupported provider: " + providerType);\n  }\n}\n')),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"3. Add configuration")," (",(0,a.yg)("inlineCode",{parentName:"p"},"EmbeddingProviderConfiguration.java"),"):"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-java"},'@Data\npublic class EmbeddingProviderConfiguration {\n  private String type = "aws-bedrock";\n  private String awsRegion = "us-west-2";\n  private String modelId = "cohere.embed-english-v3";\n\n  // Add custom provider fields\n  private String customEndpoint;\n  private int customDimensions = 1024;\n}\n')),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"4. Configure in application.yaml"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"elasticsearch:\n  search:\n    semanticSearch:\n      embeddingProvider:\n        type: custom\n        customEndpoint: http://your-embedding-service:8080/embed\n        customDimensions: 1024\n")),(0,a.yg)("h2",{id:"index-configuration"},"Index Configuration"),(0,a.yg)("h3",{id:"k-nn-settings"},"k-NN Settings"),(0,a.yg)("p",null,"The semantic index uses OpenSearch's k-NN plugin. Key parameters:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"models:\n  cohere_embed_v3:\n    # Vector size (must match model output)\n    vectorDimension: 1024\n\n    # k-NN engine: faiss (recommended) or nmslib\n    knnEngine: faiss\n\n    # Similarity metric\n    # - cosinesimil: Cosine similarity (recommended for text)\n    # - l2: Euclidean distance\n    # - innerproduct: Dot product\n    spaceType: cosinesimil\n\n    # HNSW graph parameters\n    efConstruction: 128 # Build-time accuracy (32-512)\n    m: 16 # Connections per node (4-64)\n")),(0,a.yg)("h3",{id:"parameter-tuning"},"Parameter Tuning"),(0,a.yg)("table",null,(0,a.yg)("thead",{parentName:"table"},(0,a.yg)("tr",{parentName:"thead"},(0,a.yg)("th",{parentName:"tr",align:null},"Parameter"),(0,a.yg)("th",{parentName:"tr",align:null},"Low"),(0,a.yg)("th",{parentName:"tr",align:null},"Medium"),(0,a.yg)("th",{parentName:"tr",align:null},"High"),(0,a.yg)("th",{parentName:"tr",align:null},"Trade-off"))),(0,a.yg)("tbody",{parentName:"table"},(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"efConstruction")),(0,a.yg)("td",{parentName:"tr",align:null},"32"),(0,a.yg)("td",{parentName:"tr",align:null},"128"),(0,a.yg)("td",{parentName:"tr",align:null},"512"),(0,a.yg)("td",{parentName:"tr",align:null},"Speed vs accuracy at build time")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"m")),(0,a.yg)("td",{parentName:"tr",align:null},"4"),(0,a.yg)("td",{parentName:"tr",align:null},"16"),(0,a.yg)("td",{parentName:"tr",align:null},"64"),(0,a.yg)("td",{parentName:"tr",align:null},"Memory vs accuracy")))),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Recommendations:")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Development"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"efConstruction: 64, m: 8")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Production"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"efConstruction: 128, m: 16")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"High Accuracy"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"efConstruction: 256, m: 32"))),(0,a.yg)("h3",{id:"multiple-models"},"Multiple Models"),(0,a.yg)("p",null,"Configure multiple embedding models for A/B testing or migration:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"models:\n  cohere_embed_v3:\n    vectorDimension: 1024\n    knnEngine: faiss\n    spaceType: cosinesimil\n    efConstruction: 128\n    m: 16\n\n  openai_text_embedding_3_small:\n    vectorDimension: 1536\n    knnEngine: faiss\n    spaceType: cosinesimil\n    efConstruction: 128\n    m: 16\n")),(0,a.yg)("h2",{id:"query-configuration"},"Query Configuration"),(0,a.yg)("h3",{id:"gms-query-settings"},"GMS Query Settings"),(0,a.yg)("p",null,"GMS needs credentials to generate query embeddings at search time:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"# Mount AWS credentials in Docker\nvolumes:\n  - ${HOME}/.aws:/home/datahub/.aws:ro\n\n# Set profile\nAWS_PROFILE=your-profile\n")),(0,a.yg)("h3",{id:"query-parameters"},"Query Parameters"),(0,a.yg)("p",null,"In GraphQL queries:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-graphql"},"query SemanticSearch($input: SearchAcrossEntitiesInput!) {\n  semanticSearchAcrossEntities(input: $input) {\n    # ...\n  }\n}\n")),(0,a.yg)("p",null,"Variables:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "input": {\n    "query": "your natural language query",\n    "types": ["DOCUMENT"], // Entity types to search\n    "start": 0, // Pagination start\n    "count": 10 // Results per page\n  }\n}\n')),(0,a.yg)("h2",{id:"chunking-configuration"},"Chunking Configuration"),(0,a.yg)("p",null,"Chunking is handled by the ",(0,a.yg)("strong",{parentName:"p"},"ingestion connector")," when generating document embeddings. The typical strategy:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Chunk size"),": ~400 tokens per chunk"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Boundary"),": Split at sentence boundaries when possible"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Overlap"),": Optional overlap between chunks for context continuity")),(0,a.yg)("p",null,"The chunking parameters are configured in the ingestion connector, not in GMS. GMS receives pre-chunked embeddings from the connector."),(0,a.yg)("h2",{id:"monitoring"},"Monitoring"),(0,a.yg)("h3",{id:"useful-queries"},"Useful Queries"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Check embedding coverage:")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},'curl "http://localhost:9200/documentindex_v2_semantic/_search" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "size": 0,\n    "aggs": {\n      "with_embeddings": {\n        "filter": { "exists": { "field": "embeddings.cohere_embed_v3" } }\n      },\n      "without_embeddings": {\n        "filter": { "bool": { "must_not": { "exists": { "field": "embeddings.cohere_embed_v3" } } } }\n      }\n    }\n  }\'\n')),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Check index health:")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},'curl "http://localhost:9200/_cat/indices/*semantic*?v"\n')),(0,a.yg)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,a.yg)("h3",{id:"common-issues"},"Common Issues"),(0,a.yg)("table",null,(0,a.yg)("thead",{parentName:"table"},(0,a.yg)("tr",{parentName:"thead"},(0,a.yg)("th",{parentName:"tr",align:null},"Issue"),(0,a.yg)("th",{parentName:"tr",align:null},"Cause"),(0,a.yg)("th",{parentName:"tr",align:null},"Solution"))),(0,a.yg)("tbody",{parentName:"table"},(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},'"Unable to locate credentials"'),(0,a.yg)("td",{parentName:"tr",align:null},"AWS creds not available"),(0,a.yg)("td",{parentName:"tr",align:null},"Mount ",(0,a.yg)("inlineCode",{parentName:"td"},".aws")," to ",(0,a.yg)("inlineCode",{parentName:"td"},"/home/datahub/.aws"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},'"Profile file contained no credentials"'),(0,a.yg)("td",{parentName:"tr",align:null},"SSO session expired"),(0,a.yg)("td",{parentName:"tr",align:null},"Run ",(0,a.yg)("inlineCode",{parentName:"td"},"aws sso login --profile your-profile"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},"Empty search results"),(0,a.yg)("td",{parentName:"tr",align:null},"No embeddings in index"),(0,a.yg)("td",{parentName:"tr",align:null},"Verify ingestion connector is generating embeddings")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},"Wrong results"),(0,a.yg)("td",{parentName:"tr",align:null},"Model mismatch"),(0,a.yg)("td",{parentName:"tr",align:null},"Ensure ingestion connector and GMS use the same embedding model")))),(0,a.yg)("h3",{id:"debug-logging"},"Debug Logging"),(0,a.yg)("p",null,"Enable debug logging in GMS:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"logging:\n  level:\n    com.linkedin.metadata.search: DEBUG\n")),(0,a.yg)("p",null,"Check logs for:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"[DEBUG-DUALWRITE] shouldWriteToSemanticIndex returned: true\nSemantic dual-write enabled=true, enabledEntities=[document]\n")))}c.isMDXComponent=!0}}]);