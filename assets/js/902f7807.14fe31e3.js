"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[93550],{15680:(e,n,t)=>{t.d(n,{xA:()=>d,yg:()=>m});var a=t(96540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},d=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},u="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},p=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=c(t),p=r,m=u["".concat(s,".").concat(p)]||u[p]||g[p]||i;return t?a.createElement(m,o(o({ref:n},d),{},{components:t})):a.createElement(m,o({ref:n},d))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=p;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[u]="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=t[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},17051:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>m,frontMatter:()=>l,metadata:()=>c,toc:()=>u});t(96540);var a=t(15680);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function o(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}const l={title:"Setting Up Semantic Search with AWS Bedrock in DataHub OSS",slug:"/how-to/semantic-search-aws-bedrock-setup",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/how-to/semantic-search-aws-bedrock-setup.md"},s="Setting Up Semantic Search with AWS Bedrock in DataHub OSS",c={unversionedId:"docs/how-to/semantic-search-aws-bedrock-setup",id:"docs/how-to/semantic-search-aws-bedrock-setup",title:"Setting Up Semantic Search with AWS Bedrock in DataHub OSS",description:"This guide walks you through configuring semantic search in DataHub OSS using AWS Bedrock for embedding generation.",source:"@site/genDocs/docs/how-to/semantic-search-aws-bedrock-setup.md",sourceDirName:"docs/how-to",slug:"/how-to/semantic-search-aws-bedrock-setup",permalink:"/docs/how-to/semantic-search-aws-bedrock-setup",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/how-to/semantic-search-aws-bedrock-setup.md",tags:[],version:"current",frontMatter:{title:"Setting Up Semantic Search with AWS Bedrock in DataHub OSS",slug:"/how-to/semantic-search-aws-bedrock-setup",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/how-to/semantic-search-aws-bedrock-setup.md"}},d={},u=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"1. OpenSearch Requirements",id:"1-opensearch-requirements",level:3},{value:"2. AWS Bedrock Requirements",id:"2-aws-bedrock-requirements",level:3},{value:"AWS Account Setup",id:"aws-account-setup",level:4},{value:"Enable Model Access",id:"enable-model-access",level:4},{value:"IAM Permissions",id:"iam-permissions",level:4},{value:"Configuration",id:"configuration",level:2},{value:"Step 1: Configure DataHub",id:"step-1-configure-datahub",level:3},{value:"Option A: Environment Variables (Recommended for Production)",id:"option-a-environment-variables-recommended-for-production",level:4},{value:"Option B: application.yaml",id:"option-b-applicationyaml",level:4},{value:"Step 2: Configure AWS Credentials",id:"step-2-configure-aws-credentials",level:3},{value:"Option 1: AWS Profile (Development)",id:"option-1-aws-profile-development",level:4},{value:"Option 2: Environment Variables (CI/CD)",id:"option-2-environment-variables-cicd",level:4},{value:"Option 3: EC2 Instance Role (Production - Recommended)",id:"option-3-ec2-instance-role-production---recommended",level:4},{value:"Option 4: ECS Task Role (Container Deployments)",id:"option-4-ecs-task-role-container-deployments",level:4},{value:"Step 3: Restart DataHub",id:"step-3-restart-datahub",level:3},{value:"Step 4: Verify Configuration",id:"step-4-verify-configuration",level:3},{value:"Usage",id:"usage",level:2},{value:"GraphQL API",id:"graphql-api",level:3},{value:"Single Entity Type Search",id:"single-entity-type-search",level:4},{value:"Multi-Entity Search",id:"multi-entity-search",level:4},{value:"Python SDK (Coming Soon)",id:"python-sdk-coming-soon",level:3},{value:"Backfilling Embeddings",id:"backfilling-embeddings",level:2},{value:"Using DataHub Upgrade CLI",id:"using-datahub-upgrade-cli",level:3},{value:"Configuration for Backfill",id:"configuration-for-backfill",level:3},{value:"Supported Models",id:"supported-models",level:2},{value:"Cohere Embed v3 (Default)",id:"cohere-embed-v3-default",level:3},{value:"Amazon Titan Embed",id:"amazon-titan-embed",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Issue: &quot;Semantic search is disabled or not configured&quot;",id:"issue-semantic-search-is-disabled-or-not-configured",level:3},{value:"Issue: AWS Credentials Error",id:"issue-aws-credentials-error",level:3},{value:"Issue: Bedrock Access Denied",id:"issue-bedrock-access-denied",level:3},{value:"Issue: Model Not Found",id:"issue-model-not-found",level:3},{value:"Issue: k-NN Index Creation Failed",id:"issue-k-nn-index-creation-failed",level:3},{value:"Issue: Vector Dimension Mismatch",id:"issue-vector-dimension-mismatch",level:3},{value:"Performance Tuning",id:"performance-tuning",level:2},{value:"OpenSearch k-NN Settings",id:"opensearch-k-nn-settings",level:3},{value:"AWS Bedrock Rate Limits",id:"aws-bedrock-rate-limits",level:3},{value:"Cost Estimation",id:"cost-estimation",level:2},{value:"AWS Bedrock Pricing (Cohere Embed v3)",id:"aws-bedrock-pricing-cohere-embed-v3",level:3},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"References",id:"references",level:2}],g={toc:u},p="wrapper";function m(e){var{components:n}=e,t=o(e,["components"]);return(0,a.yg)(p,i(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),a.forEach((function(n){r(e,n,t[n])}))}return e}({},g,t),{components:n,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"setting-up-semantic-search-with-aws-bedrock-in-datahub-oss"},"Setting Up Semantic Search with AWS Bedrock in DataHub OSS"),(0,a.yg)("p",null,"This guide walks you through configuring semantic search in DataHub OSS using AWS Bedrock for embedding generation."),(0,a.yg)("h2",{id:"overview"},"Overview"),(0,a.yg)("p",null,"DataHub's semantic search uses vector embeddings to find semantically similar entities. In OSS, embeddings are generated using AWS Bedrock with Cohere Embed models. This provides:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Natural language search"),': Find datasets using conversational queries like "customer churn analysis"'),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Semantic understanding"),": Match concepts even when exact keywords differ"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Cross-entity search"),": Search across datasets, dashboards, and other entities simultaneously")),(0,a.yg)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.yg)("h3",{id:"1-opensearch-requirements"},"1. OpenSearch Requirements"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"OpenSearch 2.17.0 or higher")," with k-NN plugin enabled"),(0,a.yg)("li",{parentName:"ul"},"Alternative: Elasticsearch with k-NN plugin (not officially tested)")),(0,a.yg)("p",null,"Verify k-NN plugin is enabled:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},'curl -X GET "localhost:9200/_cat/plugins?v&s=component&h=name,component,version"\n')),(0,a.yg)("p",null,"You should see ",(0,a.yg)("inlineCode",{parentName:"p"},"opensearch-knn")," in the output."),(0,a.yg)("h3",{id:"2-aws-bedrock-requirements"},"2. AWS Bedrock Requirements"),(0,a.yg)("h4",{id:"aws-account-setup"},"AWS Account Setup"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"AWS Account")," with Bedrock access"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Supported AWS Region"),": Bedrock with Cohere Embed v3 is available in:",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"us-west-2")," (Oregon) - Recommended"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"us-east-1")," (N. Virginia)"),(0,a.yg)("li",{parentName:"ul"},"Other regions - check ",(0,a.yg)("a",{parentName:"li",href:"https://docs.aws.amazon.com/bedrock/latest/userguide/what-is-bedrock.html"},"AWS Bedrock documentation"))))),(0,a.yg)("h4",{id:"enable-model-access"},"Enable Model Access"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Go to AWS Console \u2192 Amazon Bedrock \u2192 Model access"),(0,a.yg)("li",{parentName:"ol"},"Request access to ",(0,a.yg)("strong",{parentName:"li"},"Cohere Embed English v3")," (",(0,a.yg)("inlineCode",{parentName:"li"},"cohere.embed-english-v3"),")"),(0,a.yg)("li",{parentName:"ol"},"Wait for approval (usually instant for Cohere models)")),(0,a.yg)("h4",{id:"iam-permissions"},"IAM Permissions"),(0,a.yg)("p",null,"Your AWS credentials (IAM user or role) need:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": ["bedrock:InvokeModel"],\n      "Resource": [\n        "arn:aws:bedrock:*::foundation-model/cohere.embed-english-v3",\n        "arn:aws:bedrock:*::foundation-model/cohere.embed-multilingual-v3"\n      ]\n    }\n  ]\n}\n')),(0,a.yg)("p",null,"For broader access (all Bedrock models):"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "Effect": "Allow",\n  "Action": "bedrock:InvokeModel",\n  "Resource": "arn:aws:bedrock:*::foundation-model/*"\n}\n')),(0,a.yg)("h2",{id:"configuration"},"Configuration"),(0,a.yg)("h3",{id:"step-1-configure-datahub"},"Step 1: Configure DataHub"),(0,a.yg)("p",null,"Edit your ",(0,a.yg)("inlineCode",{parentName:"p"},"application.yaml")," or set environment variables:"),(0,a.yg)("h4",{id:"option-a-environment-variables-recommended-for-production"},"Option A: Environment Variables (Recommended for Production)"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"# Enable semantic search\nexport ELASTICSEARCH_SEMANTIC_SEARCH_ENABLED=true\nexport ELASTICSEARCH_SEMANTIC_SEARCH_ENTITIES=document  # Comma-separated: dataset,dashboard,chart\n\n# Configure embedding provider\nexport EMBEDDING_PROVIDER_TYPE=aws-bedrock\nexport EMBEDDING_PROVIDER_AWS_REGION=us-west-2\nexport EMBEDDING_PROVIDER_MODEL_ID=cohere.embed-english-v3\nexport EMBEDDING_PROVIDER_MAX_CHAR_LENGTH=2048\n\n# Vector index configuration\nexport ELASTICSEARCH_SEMANTIC_VECTOR_DIMENSION=1024\nexport ELASTICSEARCH_SEMANTIC_KNN_ENGINE=faiss\nexport ELASTICSEARCH_SEMANTIC_SPACE_TYPE=cosinesimil\n")),(0,a.yg)("h4",{id:"option-b-applicationyaml"},"Option B: application.yaml"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"elasticsearch:\n  index:\n    semanticSearch:\n      enabled: true\n      enabledEntities: document # Or: dataset,dashboard,chart\n      models:\n        cohere_embed_v3:\n          vectorDimension: 1024\n          knnEngine: faiss\n          spaceType: cosinesimil\n          efConstruction: 128\n          m: 16\n      embeddingProvider:\n        type: aws-bedrock\n        awsRegion: us-west-2\n        modelId: cohere.embed-english-v3\n        maxCharacterLength: 2048\n")),(0,a.yg)("h3",{id:"step-2-configure-aws-credentials"},"Step 2: Configure AWS Credentials"),(0,a.yg)("p",null,"Choose one of these authentication methods:"),(0,a.yg)("h4",{id:"option-1-aws-profile-development"},"Option 1: AWS Profile (Development)"),(0,a.yg)("p",null,"Create/edit ",(0,a.yg)("inlineCode",{parentName:"p"},"~/.aws/credentials"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-ini"},"[datahub-dev]\naws_access_key_id = YOUR_ACCESS_KEY_ID\naws_secret_access_key = YOUR_SECRET_ACCESS_KEY\n")),(0,a.yg)("p",null,"Then set the profile:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"export AWS_PROFILE=datahub-dev\n")),(0,a.yg)("h4",{id:"option-2-environment-variables-cicd"},"Option 2: Environment Variables (CI/CD)"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"export AWS_ACCESS_KEY_ID=YOUR_ACCESS_KEY_ID\nexport AWS_SECRET_ACCESS_KEY=YOUR_SECRET_ACCESS_KEY\nexport AWS_REGION=us-west-2  # Optional, uses config default if not set\n")),(0,a.yg)("h4",{id:"option-3-ec2-instance-role-production---recommended"},"Option 3: EC2 Instance Role (Production - Recommended)"),(0,a.yg)("p",null,"For production deployments on EC2:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Create an IAM role with Bedrock permissions (see IAM Permissions above)"),(0,a.yg)("li",{parentName:"ol"},"Attach the role to your EC2 instance"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"No additional configuration needed")," - credentials auto-discovered via IMDS")),(0,a.yg)("h4",{id:"option-4-ecs-task-role-container-deployments"},"Option 4: ECS Task Role (Container Deployments)"),(0,a.yg)("p",null,"For ECS/Fargate deployments:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Create an IAM role with Bedrock permissions"),(0,a.yg)("li",{parentName:"ol"},"Assign the role to your ECS task definition"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"No additional configuration needed")," - credentials auto-discovered")),(0,a.yg)("h3",{id:"step-3-restart-datahub"},"Step 3: Restart DataHub"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"# Docker Compose\ndocker-compose restart datahub-gms\n\n# Kubernetes\nkubectl rollout restart deployment datahub-gms\n")),(0,a.yg)("h3",{id:"step-4-verify-configuration"},"Step 4: Verify Configuration"),(0,a.yg)("p",null,"Check DataHub logs for successful initialization:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},'# Look for these log messages\ndocker-compose logs datahub-gms | grep -i "semantic\\|embedding"\n')),(0,a.yg)("p",null,"Expected output:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"Creating embedding provider with type: aws-bedrock\nConfiguring AWS Bedrock embedding provider: region=us-west-2, model=cohere.embed-english-v3, maxCharLength=2048\nInitialized AwsBedrockEmbeddingProvider with region=us-west-2, model=cohere.embed-english-v3, maxCharLength=2048\n")),(0,a.yg)("h2",{id:"usage"},"Usage"),(0,a.yg)("h3",{id:"graphql-api"},"GraphQL API"),(0,a.yg)("h4",{id:"single-entity-type-search"},"Single Entity Type Search"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-graphql"},'query {\n  semanticSearch(\n    input: {\n      type: DATASET\n      query: "customer churn prediction models"\n      start: 0\n      count: 10\n    }\n  ) {\n    start\n    count\n    total\n    searchResults {\n      entity {\n        urn\n        type\n        ... on Dataset {\n          name\n          description\n        }\n      }\n    }\n  }\n}\n')),(0,a.yg)("h4",{id:"multi-entity-search"},"Multi-Entity Search"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-graphql"},'query {\n  semanticSearchAcrossEntities(\n    input: {\n      types: [DATASET, DASHBOARD, CHART]\n      query: "revenue analysis last quarter"\n      start: 0\n      count: 10\n    }\n  ) {\n    start\n    count\n    total\n    searchResults {\n      entity {\n        urn\n        type\n      }\n      matchedFields {\n        name\n        value\n      }\n    }\n  }\n}\n')),(0,a.yg)("h3",{id:"python-sdk-coming-soon"},"Python SDK (Coming Soon)"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-python"},'from datahub.emitter.rest_emitter import DatahubRestEmitter\n\nemitter = DatahubRestEmitter("http://localhost:8080")\n\n# Semantic search\nresults = emitter.semantic_search(\n    query="customer data pipeline",\n    types=["dataset"],\n    start=0,\n    count=10\n)\n')),(0,a.yg)("h2",{id:"backfilling-embeddings"},"Backfilling Embeddings"),(0,a.yg)("p",null,"After enabling semantic search, you need to backfill embeddings for existing entities:"),(0,a.yg)("h3",{id:"using-datahub-upgrade-cli"},"Using DataHub Upgrade CLI"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},'# Navigate to the upgrade tool\ncd datahub-upgrade/build/install/datahub-upgrade\n\n# Run the embeddings backfill\n./bin/datahub-upgrade -u SearchEmbeddingsUpdate\n\n# Monitor progress\ndocker-compose logs -f datahub-gms | grep -i "embedding"\n')),(0,a.yg)("h3",{id:"configuration-for-backfill"},"Configuration for Backfill"),(0,a.yg)("p",null,"Environment variables for tuning backfill performance:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"# Batch size for processing entities\nexport ELASTICSEARCH_EMBEDDINGS_UPDATE_BATCH_SIZE=100\n\n# Maximum text length to embed per entity\nexport ELASTICSEARCH_EMBEDDINGS_UPDATE_MAX_TEXT_LENGTH=8000\n")),(0,a.yg)("h2",{id:"supported-models"},"Supported Models"),(0,a.yg)("h3",{id:"cohere-embed-v3-default"},"Cohere Embed v3 (Default)"),(0,a.yg)("table",null,(0,a.yg)("thead",{parentName:"table"},(0,a.yg)("tr",{parentName:"thead"},(0,a.yg)("th",{parentName:"tr",align:null},"Model ID"),(0,a.yg)("th",{parentName:"tr",align:null},"Dimensions"),(0,a.yg)("th",{parentName:"tr",align:null},"Max Tokens"),(0,a.yg)("th",{parentName:"tr",align:null},"Languages"))),(0,a.yg)("tbody",{parentName:"table"},(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"cohere.embed-english-v3")),(0,a.yg)("td",{parentName:"tr",align:null},"1024"),(0,a.yg)("td",{parentName:"tr",align:null},"512"),(0,a.yg)("td",{parentName:"tr",align:null},"English")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"cohere.embed-multilingual-v3")),(0,a.yg)("td",{parentName:"tr",align:null},"1024"),(0,a.yg)("td",{parentName:"tr",align:null},"512"),(0,a.yg)("td",{parentName:"tr",align:null},"100+ languages")))),(0,a.yg)("h3",{id:"amazon-titan-embed"},"Amazon Titan Embed"),(0,a.yg)("table",null,(0,a.yg)("thead",{parentName:"table"},(0,a.yg)("tr",{parentName:"thead"},(0,a.yg)("th",{parentName:"tr",align:null},"Model ID"),(0,a.yg)("th",{parentName:"tr",align:null},"Dimensions"),(0,a.yg)("th",{parentName:"tr",align:null},"Max Tokens"),(0,a.yg)("th",{parentName:"tr",align:null},"Languages"))),(0,a.yg)("tbody",{parentName:"table"},(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"amazon.titan-embed-text-v1")),(0,a.yg)("td",{parentName:"tr",align:null},"1536"),(0,a.yg)("td",{parentName:"tr",align:null},"8192"),(0,a.yg)("td",{parentName:"tr",align:null},"English")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"amazon.titan-embed-text-v2:0")),(0,a.yg)("td",{parentName:"tr",align:null},"1024 (configurable)"),(0,a.yg)("td",{parentName:"tr",align:null},"8192"),(0,a.yg)("td",{parentName:"tr",align:null},"English")))),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Note"),": If you change models, ensure ",(0,a.yg)("inlineCode",{parentName:"p"},"vectorDimension")," matches the model's output dimensions."),(0,a.yg)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,a.yg)("h3",{id:"issue-semantic-search-is-disabled-or-not-configured"},'Issue: "Semantic search is disabled or not configured"'),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Solution"),": Verify ",(0,a.yg)("inlineCode",{parentName:"p"},"ELASTICSEARCH_SEMANTIC_SEARCH_ENABLED=true")," and restart GMS."),(0,a.yg)("h3",{id:"issue-aws-credentials-error"},"Issue: AWS Credentials Error"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"Unable to load credentials from any provider in the chain\n")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Solutions"),":"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Verify AWS_PROFILE is set and profile exists in ",(0,a.yg)("inlineCode",{parentName:"li"},"~/.aws/credentials")),(0,a.yg)("li",{parentName:"ol"},"For EC2, verify instance role is attached: ",(0,a.yg)("inlineCode",{parentName:"li"},"curl http://169.254.169.254/latest/meta-data/iam/security-credentials/")),(0,a.yg)("li",{parentName:"ol"},"Check environment variables are set correctly")),(0,a.yg)("h3",{id:"issue-bedrock-access-denied"},"Issue: Bedrock Access Denied"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"User: arn:aws:iam::123456789:user/datahub is not authorized to perform: bedrock:InvokeModel\n")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Solution"),": Add IAM permissions (see IAM Permissions section above)."),(0,a.yg)("h3",{id:"issue-model-not-found"},"Issue: Model Not Found"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"Could not find model: cohere.embed-english-v3\n")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Solutions"),":"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Verify model access is enabled in AWS Console \u2192 Bedrock \u2192 Model access"),(0,a.yg)("li",{parentName:"ol"},"Check the region supports the model (use ",(0,a.yg)("inlineCode",{parentName:"li"},"us-west-2")," for broadest support)"),(0,a.yg)("li",{parentName:"ol"},"Ensure ",(0,a.yg)("inlineCode",{parentName:"li"},"EMBEDDING_PROVIDER_AWS_REGION")," matches where you enabled access")),(0,a.yg)("h3",{id:"issue-k-nn-index-creation-failed"},"Issue: k-NN Index Creation Failed"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"Codec [zstd_no_dict] cannot be used with k-NN indices\n")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Solution"),": This is a known issue with older DataHub versions. The semantic search port includes a fix. Ensure you have the latest code."),(0,a.yg)("h3",{id:"issue-vector-dimension-mismatch"},"Issue: Vector Dimension Mismatch"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"Dimension mismatch: expected 1024, got 1536\n")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Solution"),": Your model's dimensions don't match the configuration. Update ",(0,a.yg)("inlineCode",{parentName:"p"},"ELASTICSEARCH_SEMANTIC_VECTOR_DIMENSION")," to match your model."),(0,a.yg)("h2",{id:"performance-tuning"},"Performance Tuning"),(0,a.yg)("h3",{id:"opensearch-k-nn-settings"},"OpenSearch k-NN Settings"),(0,a.yg)("p",null,"For better performance, tune these parameters in ",(0,a.yg)("inlineCode",{parentName:"p"},"application.yaml"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"semanticSearch:\n  models:\n    cohere_embed_v3:\n      efConstruction: 128 # Higher = better recall, slower indexing (default: 128)\n      m: 16 # Higher = better recall, more memory (default: 16)\n      spaceType: cosinesimil # cosinesimil, l2, innerproduct\n      knnEngine: faiss # faiss, nmslib, lucene\n")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Recommendations"),":"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Small datasets (<10K docs)"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"efConstruction: 128, m: 16")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Medium datasets (10K-100K docs)"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"efConstruction: 256, m: 32")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Large datasets (>100K docs)"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"efConstruction: 512, m: 48"))),(0,a.yg)("h3",{id:"aws-bedrock-rate-limits"},"AWS Bedrock Rate Limits"),(0,a.yg)("p",null,"Cohere Embed v3 on Bedrock has default limits:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Requests per minute"),": 1000"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Tokens per minute"),": 200,000")),(0,a.yg)("p",null,"For higher limits, request a quota increase in AWS Service Quotas."),(0,a.yg)("h2",{id:"cost-estimation"},"Cost Estimation"),(0,a.yg)("h3",{id:"aws-bedrock-pricing-cohere-embed-v3"},"AWS Bedrock Pricing (Cohere Embed v3)"),(0,a.yg)("p",null,"As of December 2024 in us-west-2:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"$0.0001 per 1,000 input tokens")," (~750 words)")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Example costs"),":"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"10,000 datasets with 200 tokens each = 2M tokens = ",(0,a.yg)("strong",{parentName:"li"},"$0.20")),(0,a.yg)("li",{parentName:"ul"},"100,000 datasets with 200 tokens each = 20M tokens = ",(0,a.yg)("strong",{parentName:"li"},"$2.00")),(0,a.yg)("li",{parentName:"ul"},"Query embeddings: ~50 tokens per query = 10,000 queries = ",(0,a.yg)("strong",{parentName:"li"},"$0.05"))),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Monthly estimates")," (assuming daily re-indexing):"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"10K entities: ~$6/month"),(0,a.yg)("li",{parentName:"ul"},"100K entities: ~$60/month")),(0,a.yg)("p",null,"Check current pricing: ",(0,a.yg)("a",{parentName:"p",href:"https://aws.amazon.com/bedrock/pricing/"},"https://aws.amazon.com/bedrock/pricing/")),(0,a.yg)("h2",{id:"security-best-practices"},"Security Best Practices"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Use IAM Roles"),": Prefer EC2 instance roles over static credentials"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Principle of Least Privilege"),": Grant only ",(0,a.yg)("inlineCode",{parentName:"li"},"bedrock:InvokeModel")," permission"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Enable CloudTrail"),": Monitor Bedrock API calls"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Resource Tags"),": Tag IAM roles for cost tracking"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Rotate Credentials"),": If using access keys, rotate regularly")),(0,a.yg)("h2",{id:"references"},"References"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://docs.aws.amazon.com/bedrock/"},"AWS Bedrock Documentation")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://docs.cohere.com/docs/embed-2"},"Cohere Embed Models")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://opensearch.org/docs/latest/search-plugins/knn/index/"},"OpenSearch k-NN Plugin"))))}m.isMDXComponent=!0}}]);